#Herramienta del curso de Introducccion al Hacking Etico - Mastermind
#!/usr/bin/python3
#coding: utf-8

#python3 whichSystem.py 10.10.10.10

import re, sys, subprocess

def get_ttl():
        proc = subprocess.Popen(["/usr/bin/ping -c 1 %s" % ip-adress, ""], stdout=subprocess.PIPE, shell=true)
        (out, err) = proc.communicate()

        out = out.split()
        out = out[12].decode('utf-8')

        ttl_value = re.findall(r"\d{1,3}", out)[0]

        return ttl_value

def get_os():
        ttl = int(ttl)

        if ttl >= 0 and ttl<=64:
                return "Linux"
        elif ttl >=65 and ttl <=128:
                return "Windows"
        else:
                return "Not Found"

if len(sys.argv) !=2:
        print("\n[!] Use: python3 " + sys.argv[0] + "<ip-address>\n")
        sys.exit(1)

if __name__ == '__main__':
        ip_address = sys.argv[1]
        ttl = get_ttl(ip_address)
        os_name = get_os(ttl) 
        print("%s (ttl-> %s): %s" % (ip_address, ttl, os_name))

